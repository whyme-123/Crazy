<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questions and Answers</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark">

    <div class="container dark">
        <div class="button-container">
            <button class="copy-all dark" onclick="copyAll()">Copy All</button>
            <button class="toggle-theme dark" onclick="toggleTheme()">â˜€</button>
        </div>

        <div class="qa-section">
            <div class="qa-item">
                <label for="qa1">Hard Question 1 & Answer:</label>
                <pre id="qa1" class="dark">
                    Write a SQL query considering below schema. Create tables with Primary Key, foreign key
                    constraints in given schemas.
                    Manager (mid, eid, mname)
                    Department (did, mid, dname, location)
                    Employee (eid, ename, mobile, salary, joining_date, mid)
                    i.Give the name and salary of employees whose salary are greater than each and every employees who are working under manager id 14.
                    ii.Give the name of employees who have not assigned any department.
                    iii.Give the employee names whose location is Kota.
                    iv.Give the name of manager along with count of employees assigned to him/her in descending order.

                    i ==> SELECT ename, salary FROM Employee WHERE salary > (SELECT MAX(salary) FROM
                    Employee WHERE mid = 14);
                    ii ==> SELECT ename FROM Employee INNER JOIN Department ON Employee.mid =
                    Department.mid WHERE dname IS NULL;
                    iii ==> SELECT ename FROM Employee INNER JOIN Department ON Employee.mid =
                    Department.mid WHERE location = 'Kota';
                    iv ==> SELECT mname, COUNT(Employee.eid) AS employee_count FROM Manager INNER
                    JOIN Employee ON Manager.mid = Employee.mid
                    GROUP BY mname ORDER BY employee_count DESC;
                    </pre>
                <button onclick="copyText('qa1')" class="dark">Copy</button>
            </div>

            <div class="qa-item">
                <label for="qa2">Hard Question 2 & Answer:</label>
                <pre id="qa2" class="dark">
                    Write PL/pgSQL using trigger for insertion of first_name, last_name, amount and payment_id
                    into Customer_backup table when
                    deletion happens from Customer table considering below schema.
                    Customer_backup (first_name, last_name, amount, payment_id)
                    Customer (customer_id, payment_id, first_name, last_name, amount)
                    Create tables with Primary Key, foreign key constraints in given schemas.

                    CREATE OR REPLACE FUNCTION backup_customer_on_delete()
                    RETURNS TRIGGER AS $$
                    BEGIN
                    -- Insert deleted customer's data into Customer_backup table
                    INSERT INTO Customer_backup (first_name, last_name, amount, payment_id)
                    VALUES (OLD.first_name, OLD.last_name, OLD.amount, OLD.payment_id);
                    RETURN OLD;
                    END;
                    $$ LANGUAGE plpgsql;
                    CREATE TRIGGER customer_delete_trigger
                    BEFORE DELETE ON Customer
                    FOR EACH ROW
                    EXECUTE FUNCTION backup_customer_on_delete();
                    </pre>
                <button onclick="copyText('qa2')" class="dark">Copy</button>
            </div>

            <div class="qa-item">
                <label for="qa3">Hard Question 3 & Answer:</label>
                <pre id="qa2" class="dark">
                    Write PL/pgSQL using trigger for insertion of first_name, last_name, amount and payment_id
                    into Customer_backup table when
                    deletion happens from Customer table considering below schema.
                    Customer_backup (first_name, last_name, amount, payment_id)
                    Customer (customer_id, payment_id, first_name, last_name, amount)
                    Create tables with Primary Key, foreign key constraints in given schemas.
                    
                    CREATE OR REPLACE FUNCTION backup_customer_on_delete()
                    RETURNS TRIGGER AS $$
                    BEGIN
                    -- Insert deleted customer's data into Customer_backup table
                    INSERT INTO Customer_backup (first_name, last_name, amount, payment_id)
                    VALUES (OLD.first_name, OLD.last_name, OLD.amount, OLD.payment_id);
                    RETURN OLD;
                    END;
                    $$ LANGUAGE plpgsql;
                    CREATE TRIGGER customer_delete_trigger
                    BEFORE DELETE ON Customer
                    FOR EACH ROW
                    EXECUTE FUNCTION backup_customer_on_delete();
                    </pre>
                <button onclick="copyText('qa2')" class="dark">Copy</button>
            </div>

            <!-- Add more question and answer pairs as needed -->
        </div>
    </div>

    <script>
        function copyText(elementId) {
            const range = document.createRange();
            const element = document.getElementById(elementId);
            range.selectNodeContents(element);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            try {
                document.execCommand('copy');
                alert('Copied to clipboard');
            } catch (err) {
                alert('Failed to copy');
            }
            selection.removeAllRanges(); // Clear selection
        }

        function copyAll() {
            const preElements = document.querySelectorAll('.qa-item pre');
            let allText = '';
            preElements.forEach(pre => {
                allText += pre.textContent + '\n\n';
            });
            navigator.clipboard.writeText(allText).then(() => {
                alert('All questions and answers copied to clipboard');
            }).catch(() => {
                alert('Failed to copy all');
            });
        }

        function toggleTheme() {
            const body = document.body;
            const container = document.querySelector('.container');
            const copyAllButton = document.querySelector('.copy-all');
            const toggleThemeButton = document.querySelector('.toggle-theme');
            const preElements = document.querySelectorAll('pre');
            const copyButtons = document.querySelectorAll('.qa-item button');

            body.classList.toggle('dark');
            body.classList.toggle('light');

            container.classList.toggle('dark');
            container.classList.toggle('light');

            copyAllButton.classList.toggle('dark');
            copyAllButton.classList.toggle('light');

            toggleThemeButton.classList.toggle('dark');
            toggleThemeButton.classList.toggle('light');

            preElements.forEach(pre => {
                pre.classList.toggle('dark');
                pre.classList.toggle('light');
            });

            copyButtons.forEach(button => {
                button.classList.toggle('dark');
                button.classList.toggle('light');
            });

            if (body.classList.contains('dark')) {
                toggleThemeButton.textContent = 'â˜€';
            } else {
                toggleThemeButton.textContent = 'ðŸŒ™';
            }
        }
    </script>
</body>
</html>

